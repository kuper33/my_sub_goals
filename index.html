<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Цели и Задания</title>
</head>
<body>
<h1>Мои Цели по Подписчикам</h1>
<ul id="goals">
<li>Цель 1: 100 подписчиков</li>
<li>Цель 2: 500 подписчиков</li>
<li>Цель 3: 1000 подписчиков</li>
</ul>

<h1>Задания</h1>
<ul id="tasks">
</ul>

<script>
const apiKey = 'YOUR_YOUTUBE_API_KEY';
const channelId = 'YOUR_CHANNEL_ID';
let highestSubscriberCount = 0;
let lastTaskDate = '';

// реальный список заданий
const tasks = [
{ task: "Записать новое видео", chance: 0.4 },
{ task: "Сделать стрим", chance: 0.3 },
{ task: "Ответить на комментарии", chance: 0.2 },
{ task: "Сделать розыгрыш", chance: 0.1 }
];

async function getSubscriberCount() {
try {
const response = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${channelId}&key=${apiKey}`);
const data = await response.json();
if (data.items && data.items.length > 0) {
return parseInt(data.items[0].statistics.subscriberCount);
} else {
throw new Error('Channel not found');
}
} catch (error) {
console.error('Error fetching subscriber count:', error);
return 0;
}
}

function getRandomTask() {
const random = Math.random();
let cumulativeChance = 0;
for (let i = 0; i < tasks.length; i++) {
cumulativeChance += tasks[i].chance;
if (random < cumulativeChance) {
return tasks[i].task;
}
}
}

function updateTasks() {
const today = new Date().toISOString().split('T')[0];
if (today !== lastTaskDate) {
lastTaskDate = today;
const tasksElement = document.getElementById('tasks');
tasksElement.innerHTML = '';
const task = getRandomTask();
const listItem = document.createElement('li');
listItem.textContent = `${task} (Выдано: ${today})`;
tasksElement.appendChild(listItem);
}
}

async function updateGoals() {
const subscriberCount = await getSubscriberCount();
if (subscriberCount > highestSubscriberCount) {
highestSubscriberCount = subscriberCount;
updateTasks();
}
  document.getElementById('goals').innerHTML = `
<li>Цель 1: 100 подписчиков (Текущие: ${highestSubscriberCount})</li>
<li>Цель 2: 500 подписчиков</li>
<li>Цель 3: 1000 подписчиков</li>
`;
}

setInterval(updateGoals, 86400000); // обновлять каждый день
updateGoals();
</script>
</body>
</html>
